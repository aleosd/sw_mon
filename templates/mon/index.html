{% extends "base.html" %}
{% load i18n %}

{% block title %}
Monitoring
{% endblock %}

{% block script %}

<!-- Tooltip script -->
<script type="text/javascript">
$(function(){
  $('body').tooltip({
      selector: "[rel=tooltip]",
      placement: "top",
      html: true
  });
});
</script>

<!-- table-sorting script -->
<script>
$(document).ready(function()
    {
        $("#sw_table").tablesorter({sortList: [[0,0]]});
    }
);
</script>

{% endblock script %}

{% block sidemenu %}
<div class="well well-small">
<ul class="nav nav-list">
    <li><p class="text-center muted{# {% if bad_ping > 0 %} text-error{% endif %} #}">
        {% language "ru" %}{% now "SHORT_DATETIME_FORMAT" %}{% endlanguage %}</p></li>
    <input id="search" type="text" class="input-medium" placeholder="{% trans "Search" %}"
                                                    autofocus="autofocus" />
    <li class="nav-header">{% trans "Status" %}</li>
    {% if not status %}
        <li id="all" class="active clearfix">
            <a href="/mon/">{% trans "All" %}<span class="pull-right">{{ switch_list|length }}</span></a></li>
        <li id="warn" class="clearfix">
            <a href="#">{% trans "Warning" %}<span class="pull-right">{{ bad_uptime }}</span></a></li>
        <li id="err" class="clearfix">
            <a id="err" {% if bad_ping > 0 %}class="text-error" {% endif %} href="#">{% trans "Error" %}
            <span class="pull-right">{{ bad_ping }}</span></a>
        </li>
    {% elif status == "errors" %}
        <li><a href="/mon/">{% trans "All" %}</a></li>
        <li><a href="/mon/status/warnings/">{% trans "Warning" %}</a></li>
        <li class="active"><a href="/mon/status/errors/">{% trans "Error" %}</a></li>
    {% elif status == "warnings" %}
        <li><a href="/mon/">{% trans "All" %}</a></li>
        <li class="active"><a href="/mon/status/warnings/">{% trans "Warning" %}</a></li>
        <li><a href="/mon/status/errors/">{% trans "Error" %}</a></li>
    {% endif %}
        <li class="divider"></li>
        <li><a href="/new/">{% trans "Add Switch" %}</a><li>
</ul>
</div>
{% endblock %}

{% block maincontent %}


{% if switch_list %}
    <table id="sw_table" class="table table-bordered table-hover table-condensed tablesorter">
        <thead>
        <tr>
            <th>â„–</th>
            <th>{% trans "Address" %}</th>
            <th>IP</th>
            <th>{% trans "Ping" %}</th>
            <th>{% trans "Uptime" %}</th>
            <th>{% trans "Type" %}</th>
        </tr>
        </thead>

        <tbody>
        {% for switch in switch_list %}
            {% if not switch.sw_ping %}
            <tr class="error">
            {% elif switch.sw_uptime < 86400 or not switch.sw_uptime %}
            <tr class="warning">
            {% elif switch.sw_uptime > 1209600 %}
            <tr class="info">
            {% else %}
            <tr>
            {% endif %}
                <td>{{ switch.sw_id }}</td>
                <td id="sw_addr">
                    <a href="{% url 'view' switch.id %}"
                       {% if switch.sw_device or switch.sw_comment %}
                       rel="tooltip"
                       data-original-title="{% if switch.sw_device %}
                                                {% trans "Model" %}: {{ switch.sw_device.str_for_tooltip }}
                                            {% endif %}
                                            {%if switch.sw_comment %}
                                                {% trans "Comment" %}: {{ switch.sw_comment }}
                                            {% endif %}"
                       {% endif %}>
                     {{ switch.sw_street }}, {{ switch.sw_build_num }}</a>
                </td>
                <td id="sw_ip">{{ switch.ip_addr }}</td>
                <td>{{ switch.sw_ping|default:"Error" }}</td>
                <td>{{ switch.sw_uptime_str|default:"Unknown" }}</td>
                <td id="sw_type">{{ switch.sw_type }}</td>
            </tr>

        {% endfor %}
        </tbody>
        </table>
{% else %}
    <p>No {{ status }} switches in the database</p>
{% endif %}
{% endblock %}
